<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>PiText - Calendar</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" type="image/x-icon" href="/travel/static/PiText_favicon.ico" />

  <!-- CSS Files -->
  <link rel="stylesheet" href="/travel/static/css/base.css" />
  <link rel="stylesheet" href="/travel/static/css/calendar.css"/>
</head>
<body>
  <div class="container">
    <header>
      <h1>ðŸ“… Calendar</h1>
    </header>

    <main>
      <!-- Calendar Container -->
      <div id="calendar"></div>
      
      <!-- Test Controls -->
      <div class="test-controls">
        <h3>Test Controls</h3>
        <button onclick="testCreateEvent()">Create Test Event</button>
        <button onclick="testRefresh()">Refresh Calendar</button>
        <button onclick="testNavigate()">Go to Today</button>
        <button onclick="testChangeView()">Switch to Week View</button>
      </div>
    </main>
  </div>

  <!-- FullCalendar Library -->
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.js"></script>

  <!-- Calendar Integration -->
  <script src="/travel/static/js/calendar/index.js"></script>

  <!-- Test Functions -->
  <script>
    function testCreateEvent() {
      if (window.piTextCalendar) {
        const testEvent = {
          title: 'Test Event',
          start_time: new Date().toISOString(),
          end_time: new Date(Date.now() + 2 * 60 * 60 * 1000).toISOString(),
          location: 'Test Location',
          description: 'This is a test event created from the test controls.',
          type: 'activity'
        };
        
        window.piTextCalendar.createEvent(testEvent)
          .then(result => {
            console.log('Test event created:', result);
            alert('Test event created successfully!');
          })
          .catch(error => {
            console.error('Failed to create test event:', error);
            alert('Failed to create test event: ' + error.message);
          });
      } else {
        alert('Calendar not initialized yet');
      }
    }

    function testRefresh() {
      if (window.piTextCalendar) {
        window.piTextCalendar.refresh()
          .then(() => {
            console.log('Calendar refreshed');
            alert('Calendar refreshed successfully!');
          })
          .catch(error => {
            console.error('Failed to refresh calendar:', error);
            alert('Failed to refresh calendar: ' + error.message);
          });
      } else {
        alert('Calendar not initialized yet');
      }
    }

    function testNavigate() {
      if (window.piTextCalendar) {
        window.piTextCalendar.navigateToDate(new Date());
        console.log('Navigated to today');
        alert('Navigated to today!');
      } else {
        alert('Calendar not initialized yet');
      }
    }

    function testChangeView() {
      if (window.piTextCalendar) {
        const currentView = window.piTextCalendar.getCalendar().view.type;
        const newView = currentView === 'timeGridWeek' ? 'dayGridMonth' : 'timeGridWeek';
        window.piTextCalendar.changeView(newView);
        console.log('Changed view to:', newView);
        alert('Changed view to ' + newView + '!');
      } else {
        alert('Calendar not initialized yet');
      }
    }

    // Listen for calendar ready event
    window.addEventListener('calendarReady', function(event) {
      console.log('Calendar is ready:', event.detail);
      document.querySelector('.test-controls').style.display = 'block';
    });
  </script>

  <style>
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    header {
      text-align: center;
      margin-bottom: 30px;
    }

    header h1 {
      color: #667eea;
      margin-bottom: 10px;
    }

    .test-controls {
      margin-top: 30px;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 8px;
      display: none;
    }

    .test-controls h3 {
      margin-top: 0;
      color: #495057;
    }

    .test-controls button {
      margin: 5px;
      padding: 10px 20px;
      background: #667eea;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .test-controls button:hover {
      background: #5a67d8;
      transform: translateY(-1px);
    }
  </style>
</body>
</html> 